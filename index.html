<head>
	<style> body { margin: 0; } </style>
      
	<script src="//unpkg.com/globe.gl"></script>
	<!--<script src="../../dist/three-globe.js"></script>-->
      </head>
      
      <body>
      <div id="globeViz"></div>
      
      <script>
	  const world = new Globe()
	    (document.getElementById('globeViz'))
	    .globeImageUrl('//unpkg.com/three-globe/example/img/earth-dark.jpg')
	    .polygonCapColor(() => 'rgba(200, 0, 0, 0.7)')
	    .polygonSideColor(() => 'rgba(200, 0, 0, 0.7)')
	    .polygonStrokeColor(() => '#111')
	    .polygonLabel(({ properties: d }) => `
          <b>${d.ADMIN} (${d.ISO_A2})</b>`);
      
	fetch('./ne_110m_admin_0_countries.geojson').then(res => res.json()).then(countries =>
	{
	  world.polygonsData(countries.features.filter(d => d.properties.ISO_A2 !== 'AQ'));
	// Auto-rotate
	 world.controls().autoRotate = true;
   	world.controls().autoRotateSpeed = 1.8;
	  console.log(world.polygonAltitude());
      
	  alt = [
	{
	  "country": "US",
	  "count": "345"
	},
	{
	  "country": "PL",
	  "count": "92"
	},
	{
	  "country": "FR",
	  "count": "22"
	},
	{
	  "country": "HR",
	  "count": "14"
	},
	{
	  "country": "BY",
	  "count": "9"
	},
	{
	  "country": "BE",
	  "count": "7"
	},
	{
	  "country": "CZ",
	  "count": "7"
	},
	{
	  "country": "DE",
	  "count": "6"
	},
	{
	  "country": "BR",
	  "count": "5"
	},
	{
	  "country": "CH",
	  "count": "4"
	},
	{
	  "country": "NL",
	  "count": "4"
	},
	{
	  "country": "ES",
	  "count": "4"
	},
	{
	  "country": "ZA",
	  "count": "3"
	},
	{
	  "country": "CA",
	  "count": "2"
	},
	{
	  "country": "CN",
	  "count": "1"
	},
	{
	  "country": "PT",
	  "count": "1"
	},
	{
	  "country": "HK",
	  "count": "1"
	},
	{
	  "country": "DK",
	  "count": "1"
	},
	{
	  "country": "IL",
	  "count": "1"
	},
	{
	  "country": "BH",
	  "count": "1"
	},
	{
	  "country": "GB",
	  "count": "1"
	},
	{
	  "country": "UY",
	  "count": "1"
	},
	{
	  "country": "NZ",
	  "count": "1"
	},
	{
	  "country": "PE",
	  "count": "1"
	},
	{
	  "country": "VN",
	  "count": "1"
	},
	{
	  "country": "AR",
	  "count": "1"
	}
      ];
      
	  var countTotal = alt.reduce(function(prev, cur) {
	    return Number(prev) + Number(cur.count);
	  }, 0);
      
	  setTimeout(() => world.polygonAltitude((a) => { 
      
	  //console.log(a); 
      
	  d = alt.find(x => x.country === a.properties.ISO_A2);
	  if(d) {
	    pct = d.count/countTotal;
	    return pct;
	  }
	  else 
	    return NaN; 
	  }), 1);
      
	 
	  
	});
      </script>
      </body>